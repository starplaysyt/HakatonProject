@{
    ViewData["Title"] = "Home Page";

    var events = new[]
    {
        new { Name = "Культура", Start = "10:00", End = "12:00", Icon = "fa7-solid:museum" },
        new { Name = "Спорт", Start = "12:30", End = "14:00", Icon = "fa7-solid:basketball" },
        new { Name = "Музыка", Start = "15:00", End = "17:00", Icon = "fa7-solid:music" }
    };
}

@section Scripts
{
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Получаем данные с бэкенда через fetch
            fetch('/api/ChartData/owner-events')
                .then(response => response.json())
                .then(chartData => {
                    const ctx = document.getElementById('weekStatsChart').getContext('2d');
                    new Chart(ctx, {
                        type: 'bar',
                        data: chartData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false, // Позволяет графику заполнить контейнер

                            // Отключаем легенду (кружок с надписью "Активность")
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    enabled: false // Отключаем подсказки при наведении
                                }
                            },
                            indexAxis: 'x',
                            // Настройка осей
                            scales: {
                                // Ось X (Дни недели)
                                x: {
                                    position: 'top', // Метки 'ПН', 'ВТ' будут сверху
                                    grid: {
                                        display: false // Убираем вертикальные линии сетки
                                    },
                                    border: {
                                        display: false // Убираем саму ось X
                                    },
                                    ticks: {
                                        color: '#E0E0E0' // Цвет текста меток
                                    },
                                    stacked: false
                                },
                                // Ось Y (Время)
                                y: {
                                    min: 10,  // Начинаем с 10:00
                                    max: 20,  // Заканчиваем в 20:00
                                    grid: {
                                        color: '#4A4C60', // Цвет горизонтальных линий сетки
                                        drawTicks: false // Убираем "засечки" на оси
                                    },
                                    border: {
                                        display: false // Убираем саму ось Y
                                    },
                                    ticks: {
                                        color: '#E0E0E0', // Цвет текста (10:00, 12:00...)
                                        stepSize: 2, // Шаг в 2 часа
                                        // Форматируем метки, чтобы было "10:00", а не "10"
                                        callback: function (value, index, ticks) {
                                            return value + ':00';
                                        },
                                        padding: 10 // Отступ меток от края
                                    },
                                    stacked: false
                                }
                            }
                        }
                    });
                })
                .catch(error => console.error('Ошибка при загрузке данных для Chart.js:', error));
        });
                </script>
}

<div class="dashboard-container">
    <nav class="sidebar">
        <div class="sidebar-logo">
            <img alt="logo" src="logo.png">
            Active Graph
        </div>
        <ul class="sidebar-nav">
            <li><a href="#"><span class="iconify" data-icon="mynaui:home"></span></a></li>
            <li><a href="#"><span class="iconify" data-icon="material-symbols:interests-rounded"></span></a></li>
            <li><a href="#"><span class="iconify" data-icon="material-symbols:event-note-rounded"></span></a></li>
        </ul>
        <div class="sidebar-profile">
            <span class="iconify" data-icon="iconamoon:profile"></span>
        </div>
    </nav>

    <main class="main-content">

        <div class="widget welcome-card">
            <div class="welcome-header">
                <div class="user-icon"><span class="iconify" data-icon="iconamoon:profile"></span></div>
                <h2>Привет, Андрей</h2>
            </div>
            <div class="sample-cards">
                <div class="sample-card">
                    <span class="iconify" data-icon="mynaui:home"></span>
                    <p>Home</p>
                </div>
                <div class="sample-card">
                    <span class="iconify" data-icon="mynaui:home"></span>
                    <p>Home</p>
                </div>
                <div class="sample-card">
                    <span class="iconify" data-icon="mynaui:home"></span>
                    <p>Home</p>
                </div>
            </div>
        </div>

        <div class="widget stats-card">
            <div class="stats-header">
                <h3>Статистика</h3>
                <div class="date-range">
                    <button id="btn-date"><span class="iconify" data-icon="mdi:navigate-before"></span></button>
                    10.02-17.02
                    <button id="btn-date"><span class="iconify" data-icon="mdi:navigate-next"></span></button>
                </div>
            </div>

            <div class="chart-wrapper">
                <canvas id="weekStatsChart"></canvas>

                
            </div>
        </div>

        <div class="widget events-card">
            <div class="header-ec"><h3><span class="iconify" data-icon="material-symbols:event-note-rounded"></span>
                    Мероприятия</h3></div>
            <ul class="event-list">
                @foreach (var e in events)
                {
                    <li>
                        <div class="event-icon"><span class="iconify" data-icon="@e.Icon"></span></div>
                        <div class="event-details">
                            <strong>@e.Name</strong>
                            <span>@e.Start - @e.End</span>
                        </div>
                    </li>
                }
                @* <li> *@
                @* <div class="event-icon"><span class="iconify" data-icon="fluent:sport-16-filled"></span></div> *@
                @* <div class="event-details"> *@
                @* <strong>Спорт</strong> *@
                @* <span>время начала-время конца</span> *@
                @* </div> *@
                @* </li> *@
                @* <li> *@
                @* <div class="event-icon"><span class="iconify" data-icon="mdi:volunteer"></span></div> *@
                @* <div class="event-details"> *@
                @* <strong>Волонтерство</strong> *@
                @* <span>время начала-время конца</span> *@
                @* </div> *@
                @* </li> *@
                @* <li> *@
                @* <div class="event-icon"><span class="iconify" data-icon="material-symbols:science"></span></div> *@
                @* <div class="event-details"> *@
                @* <strong>Наука</strong> *@
                @* <span>время начала-время конца</span> *@
                @* </div> *@
                @* </li> *@
                @* <li> *@
                @* <div class="event-icon"><span class="iconify" data-icon="mdi:court-hammer"></span></div> *@
                @* <div class="event-details"> *@
                @* <strong>Студ. самоуправ.</strong> *@
                @* <span>время начала-время конца</span> *@
                @* </div> *@
                @* </li> *@
            </ul>
        </div>

    </main>
</div>


